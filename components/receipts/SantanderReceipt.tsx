import React from 'react';
import { TransactionData } from '../../types';
import { formatarCPFCNPJ, formatarValor } from '../../utils';

interface ReceiptProps {
  data: TransactionData;
}

const SantanderLogo = () => (
    <div className="flex flex-col items-center justify-center mb-2">
        <svg width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M47.5 24C47.5 36.975 36.975 47.5 24 47.5C11.025 47.5 0.5 36.975 0.5 24C0.5 11.025 11.025 0.5 24 0.5C36.975 0.5 47.5 11.025 47.5 24Z" fill="#EC0000" stroke="#EC0000" strokeWidth="1"/>
            <path d="M24.2422 10.5938C22.6562 10.5938 21.0703 11.0156 19.75 11.8594C18.4297 12.7031 17.5 13.8438 17.0312 15.2812C16.5625 16.7188 16.5625 18.25 17.0312 19.6875C17.5 21.125 18.4297 22.2656 19.75 23.1094C20.6953 23.6875 21.7344 24.125 22.8672 24.4219C22.0703 25.1094 21.3984 25.9688 20.8516 26.9062C19.8438 28.5312 19.3359 30.4062 19.3359 32.5312C19.3359 33.6875 19.5234 34.8125 19.8984 35.8125C20.2734 36.8125 20.8984 37.5 21.7734 37.875C21.8984 37.9375 22.0234 37.9375 22.1484 37.9375C22.5859 37.9375 22.9922 37.75 23.2344 37.3125C23.8281 36.2188 24.1562 34.9375 24.1562 33.5625C24.1562 31.5 24.8906 29.5 26.3594 27.5625C27.8281 25.625 30.0703 23.9062 33.0703 22.4062V22.3438C30.6953 20.9688 29.1875 19.0312 28.5625 16.5312C27.9375 14.0312 26.3594 10.5938 24.2422 10.5938Z" fill="white"/>
            <path d="M25.7578 33.5C25.7578 34.9375 26.1172 36.2188 26.7109 37.25C26.9531 37.6875 27.3594 37.875 27.7969 37.875C27.9219 37.875 28.0469 37.875 28.1719 37.8125C29.0469 37.4375 29.6719 36.75 30.0469 35.75C30.4219 34.75 30.6094 33.625 30.6094 32.4688C30.6094 30.3438 30.0703 28.4688 29.0625 26.8438C28.5156 25.9062 27.8438 25.0469 27.0469 24.3594C28.1797 24.0625 29.2188 23.625 30.1641 23.0469C31.4844 22.2031 32.4141 21.0625 32.8828 19.625C33.3516 18.1875 33.3516 16.6562 32.8828 15.2188C32.4141 13.7812 31.4844 12.6406 30.1641 11.7969C28.8438 10.9531 27.2578 10.5312 25.6719 10.5312C23.5547 10.5312 21.8828 14.0312 22.5703 16.5312C23.1953 19.0312 24.6406 20.9688 26.9844 22.2812V22.3438C24.0156 23.8438 21.7734 25.5625 20.3047 27.5C18.8359 29.4375 18.1016 31.4375 18.1016 33.5C18.1016 35.0625 18.4609 36.375 19.1562 37.4375L19.2188 37.5C19.5 37.9375 19.9688 38.1875 20.5234 38.1875C21.4688 38.1875 22.3281 37.5625 22.6406 36.625C22.9531 35.6875 23.1094 34.625 23.1094 33.5C23.1094 31.1875 23.8438 29.0625 25.1328 27.125C26.4219 25.1875 28.2422 23.6875 30.5859 22.625C31.3828 22.25 32.0781 21.6875 32.6719 20.9375C33.2656 20.1875 33.6875 19.3125 33.9375 18.3125C34.1875 17.3125 34.25 16.25 34.125 15.125C33.6875 13.4375 32.6719 12.0625 31.0859 11.0312C29.5 9.9375 27.5312 9.21875 25.1875 9.21875C22.8438 9.21875 20.5312 10.25 18.8828 12.3125C17.2344 14.375 16.3594 17.0625 17.2969 20.375C17.7656 22.125 18.75 23.6562 20.2422 24.875L20.1875 24.9375C18.5703 23.5 17.4375 21.6875 16.9688 19.5C16.5 17.3125 16.5 15.125 17.1875 12.9375C17.875 10.75 19.25 8.9375 21.3125 7.5C23.375 6.0625 25.8438 5.625 28.7188 6.5625C31.5938 7.5 33.8594 9.4375 35.5078 12.375C37.1562 15.3125 37.1562 18.625 35.5078 21.5625C33.8594 24.5 31.5938 26.4375 28.7188 27.375C25.8438 28.3125 23.375 27.875 21.3125 26.4375C19.25 25 17.875 23.1875 17.1875 20.9375H17.125C17.8125 23.125 19.1875 24.9375 21.25 26.375C23.3125 27.8125 25.7812 28.25 28.6562 27.3125C31.5312 26.375 33.7969 24.4375 35.4453 21.5C37.0938 18.5625 37.0938 15.25 35.4453 12.3125C33.7969 9.375 31.5312 7.4375 28.6562 6.5C25.7812 5.5625 23.3125 6 21.25 7.4375C19.1875 8.875 17.8125 10.6875 17.125 12.875C16.4375 15.0625 16.4375 17.25 16.9062 19.4375C17.375 21.625 18.5078 23.4375 20.125 24.875L20.1875 24.8125C18.6875 23.5938 17.7031 22.0625 17.2344 20.3125C16.3281 17 17.1875 14.3125 18.8438 12.25C20.5 10.1875 22.7812 9.15625 25.6562 9.21875C28.5312 9.28125 30.8125 10.3125 32.5 12.3125C34.1875 14.3125 35.0312 17 34.125 20.3125C33.6562 22.0625 32.6719 23.5938 31.1875 24.8125L31.2422 24.875C32.75 23.6562 33.7344 22.125 34.2031 20.375C35.0938 17.0625 34.25 14.375 32.5938 12.3125C30.9375 10.25 28.625 9.21875 25.75 9.21875C22.875 9.21875 20.5938 10.25 18.9062 12.25C17.2188 14.25 16.3594 16.9375 17.2969 20.25C17.7656 21.9375 18.75 23.5 20.2422 24.75L20.1875 24.8125C18.5703 23.375 17.4375 21.5625 16.9688 19.375C16.5 17.1875 16.5 15 17.1875 12.8125C17.875 10.625 19.25 8.8125 21.3125 7.375C23.375 5.9375 25.8438 5.5 28.7188 6.4375C31.5938 7.375 33.8594 9.3125 35.5078 12.25C37.1562 15.1875 37.1562 18.5 35.5078 21.4375C33.8594 24.375 31.5938 26.3125 28.7188 27.25C25.8438 28.1875 23.375 27.75 21.3125 26.3125C19.25 24.875 17.875 23.0625 17.1875 20.8125H17.125C17.8125 23.0625 19.1875 24.875 21.25 26.3125C23.3125 27.75 25.7812 28.1875 28.6562 27.25C31.5312 26.3125 33.7969 24.375 35.4453 21.4375C37.0938 18.5 37.0938 15.1875 35.4453 12.25C33.7969 9.3125 31.5312 7.375 28.6562 6.4375C25.7812 5.5 23.3125 5.9375 21.25 7.375C19.1875 8.8125 17.8125 10.625 17.125 12.8125C16.4375 15 16.4375 17.1875 16.9062 19.375C17.375 21.5625 18.5078 23.375 20.125 24.8125L20.1875 24.75C18.6875 23.5312 17.7031 22 17.2344 20.25C16.3281 16.9375 17.1875 14.25 18.8438 12.1875C20.5 10.125 22.7812 9.09375 25.6562 9.15625C28.5312 9.21875 30.8125 10.25 32.5 12.25C34.1875 14.25 35.0312 16.9375 34.125 20.25C33.6562 22 32.6719 23.5312 31.1875 24.75L31.2422 24.8125C32.75 23.5938 33.7344 22.0625 34.2031 20.3125C35.0938 17 34.25 14.3125 32.5938 12.25C30.9375 10.1875 28.625 9.15625 25.75 9.15625C22.875 9.15625 20.5938 10.1875 18.9062 12.1875C17.2188 14.1875 16.3594 16.875 17.2969 20.1875C17.7656 21.875 18.75 23.4375 20.2422 24.6875L20.1875 24.75C18.5703 23.3125 17.4375 21.5 16.9688 19.3125C16.5 17.125 16.5 14.9375 17.1875 12.75C17.875 10.5625 19.25 8.75 21.3125 7.3125C23.375 5.875 25.8438 5.4375 28.7188 6.375C31.5938 7.3125 33.8594 9.25 35.5078 12.1875C37.1562 15.125 37.1562 18.4375 35.5078 21.375C33.8594 24.3125 31.5938 26.25 28.7188 27.1875C25.8438 28.125 23.375 27.6875 21.3125 26.25C19.25 24.8125 17.875 23 17.1875 20.75H17.125C17.8125 23 19.1875 24.8125 21.25 26.25C23.3125 27.6875 25.7812 28.125 28.6562 27.1875C31.5312 26.25 33.7969 24.3125 35.4453 21.375C37.0938 18.4375 37.0938 15.125 35.4453 12.1875C33.7969 9.25 31.5312 7.3125 28.6562 6.375C25.7812 5.4375 23.3125 5.875 21.25 7.3125C19.1875 8.75 17.8125 10.5625 17.125 12.75C16.4375 14.9375 16.4375 17.125 16.9062 19.3125C17.375 21.5 18.5078 23.3125 20.125 24.75L20.1875 24.6875C18.6875 23.5 17.7031 21.9375 17.2344 20.1875C16.3281 16.875 17.1875 14.1875 18.8438 12.125C20.5 10.0625 22.7812 9.03125 25.6562 9.09375C28.5312 9.15625 30.8125 10.1875 32.5 12.1875C34.1875 14.1875 35.0312 16.875 34.125 20.1875C33.6562 21.9375 32.6719 23.5 31.1875 24.6875L31.2422 24.75C32.75 23.5312 33.7344 22 34.2031 20.25C35.0938 16.9375 34.25 14.25 32.5938 12.1875C30.9375 10.125 28.625 9.09375 25.75 9.09375C22.875 9.09375 20.5938 10.125 18.9062 12.125C17.2188 14.125 16.3594 16.8125 17.2969 20.125C17.7656 21.8125 18.75 23.375 20.2422 24.625Z" fill="white"/>
        </svg>
        <p className="font-bold text-lg text-gray-700 tracking-wider mt-2">Santander</p>
    </div>
);


const SantanderReceipt: React.FC<ReceiptProps> = ({ data }) => {
    const formatarDataHora = (dataHora: string): string => {
        if (!dataHora) return '';
        try {
            const date = new Date(dataHora);
            const dia = String(date.getDate()).padStart(2, '0');
            const mes = String(date.getMonth() + 1).padStart(2, '0');
            const ano = date.getFullYear();
            const horas = String(date.getHours()).padStart(2, '0');
            const minutos = String(date.getMinutes()).padStart(2, '0');
            return `${dia}/${mes}/${ano} - ${horas}:${minutos}`;
        } catch (error) { return 'Data inválida'; }
    };
    
  const Section: React.FC<{title: string, children: React.ReactNode}> = ({title, children}) => (
    <div className="mb-5">
        <h3 className="text-sm font-semibold text-gray-500 pb-2 mb-2">{title}</h3>
        <div className="space-y-4">{children}</div>
    </div>
  );

  const InfoPair: React.FC<{label: string, value: string | undefined}> = ({label, value}) => (
    <div>
        <p className="text-gray-900 font-semibold">{label}</p>
        <p className="text-gray-800 font-bold">{value || '-'}</p>
    </div>
  );

  return (
    <div className="font-sans bg-white p-6 max-w-md mx-auto text-sm">
        
        <div className="text-center mb-6">
            <SantanderLogo />
            <h1 className="text-xl font-bold text-gray-800 mt-2">Comprovante do Pix</h1>
            <p className="text-gray-500 mt-1">{formatarDataHora(data.dataHora)}</p>
        </div>
        
        <hr className="my-6 border-gray-200"/>

        <div className="mb-6">
            <p className="text-gray-900 font-semibold">Valor pago</p>
            <p className="text-2xl font-bold text-gray-900">{formatarValor(data.valor)}</p>
        </div>

        <Section title="Dados do recebedor">
            <InfoPair label="Para" value={data.nomeDestino} />
            <InfoPair label="CNPJ" value={formatarCPFCNPJ(data.cpfCnpjDestino)} />
            {data.chavePixDestino && <InfoPair label="Chave" value={data.chavePixDestino} />}
            <InfoPair label="Instituição" value={data.instituicaoDestino} />
        </Section>
        
        <Section title="Dados do pagador">
            <InfoPair label="De" value={data.nomeOrigem} />
            <InfoPair label="CPF" value={formatarCPFCNPJ(data.cpfCnpjOrigem)} />
            <InfoPair label="Instituição" value={data.instituicaoOrigem} />
        </Section>

        <div className="mt-8 border-t border-gray-200 pt-4">
             <InfoPair label="ID/Transação" value={data.idTransacao} />
        </div>

        <div className="text-right text-xs text-gray-400 mt-8">
            <p>Comprovante do Pix</p>
            <p>1/2</p>
        </div>
    </div>
  );
};

export default SantanderReceipt;
